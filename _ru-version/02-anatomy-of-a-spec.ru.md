# Анатомия Спецификации (Spec)

## 1. Введение: чертеж для генерации

Этот документ представляет собой концептуальное руководство по созданию высококачественной Спецификации (Spec). Спецификация — это инженерный чертеж, который направляет весь **[Жизненный цикл Артефакта](./03-the-artifact-lifecycle.md)**. Ее качество является единственным наиболее значимым предиктором качества конечного цифрового продукта.

Крайне важно понимать, что описанная здесь "анатомия" — это **гибкая концептуальная модель, а не жесткий шаблон.** Цель специалиста — четко зафиксировать свое намерение. Структура `Спецификации` должна служить этой цели. Для простых задач `Спецификация` может представлять собой краткий декларативный список критериев. Для сложных задач она может развиться в подробное процедурное руководство.

Профессиональная Спецификация предназначена для двух аудиторий: эксперта-человека, который должен валидировать результат, и ИИ, который должен его сгенерировать. Она достигает этого, будучи прямым отражением ясности и намерения автора.

## 2. Позиция автора: искусство создания Спецификации

Прежде чем изучать структуру Спецификации, необходимо сначала принять правильный образ мышления. Качество Спецификации является прямым результатом двух ключевых принципов:

*   **Дисциплина мышления:** Автор должен быть ясным, твердым и недвусмысленным в своем мышлении. Расплывчатый запрос приведет к расплывчатому результату. Это основополагающий навык нового поколения операторов ИИ: способность формулировать цель, разбивать задачу на части и понимать категории данных, действий и ограничений.
*   **Уважение к энергии внимания:** Автор должен быть кратким и сосредоточенным, уважая как свое время, так и вычислительные ресурсы ИИ. Великая Спецификация — это не поток сознания; это тщательно созданный инструмент, предназначенный для конкретной цели. Перегруженные, неясные или "пустые" запросы приведут к хаотичному и бесполезному результату.

Овладение этими двумя принципами — это то, что поднимает создание Спецификации с уровня канцелярской задачи до уровня инженерного искусства.

## 3. Анатомия: от намерения к исполнимому контракту

Структура Спецификации разработана для перевода дисциплинированной мысли автора в исполнимый контракт, который ИИ может понять, а человек — проверить. Она состоит из трех основных частей: Цель, Обоснование и Критерии проверки.

### 3.1. Практические разновидности Спецификации
Хотя `Спецификация` — это единая концепция, на практике она может принимать несколько форм в зависимости от ее цели. Комплексная генеративная задача часто будет состоять из нескольких таких форм, используя разделы ниже в качестве контейнеров для каждого типа информации.

*   **Продуктовая спецификация:** Определяет пользовательские истории, диаграммы потоков и KPI.
*   **Техническая спецификация:** Описывает интерфейсы, контракты данных и бюджеты производительности.
*   **Спецификация безопасности/управления:** Содержит промпты для red-team атак, этические границы и юридические ограничения.
*   **Тестовая спецификация:** Предоставляет формальные пары входных/выходных данных и утверждения на основе свойств.

### 3.2. Цель: определение "Что"
Спецификация должна начинаться с четкого, явного и краткого изложения основной цели. Это прямое применение принципа "Дисциплина мышления".

**Пример:**
> Создать переиспользуемый React-хук с именем `useDebounce`, который принимает значение и время задержки и возвращает отложенное значение.

### 3.3. Обоснование: объяснение "Почему"
Спецификация должна предоставлять необходимый контекст и ограничения. В этом разделе автор **устанавливает персону ИИ**, настраивая его на желаемый экспертный контекст (например, "Ты — старший фронтенд-разработчик, специализирующийся на производительных React-приложениях").

*   **Бизнес-обоснование:** Бизнес-правила, цели или ценность для пользователя, которые оправдывают задачу.
*   **Технические ограничения:** Требуемые библиотеки, фреймворки, стандарты кодирования или архитектурные паттерны.

**Пример:**
> Хук будет использоваться в строке поиска нашего приложения для предотвращения чрезмерных вызовов API во время набора текста пользователем. Он должен быть написан на TypeScript, использовать современные паттерны функциональных компонентов и не должен зависеть от каких-либо внешних библиотек для логики отложенного выполнения.

### 3.4. Критерии проверки и примеры: указание "Как"
Этот раздел делает Спецификацию исполнимым контрактом, явно **указывая формат вывода**. Критерии должны представлять собой четкий, проверяемый список, и по возможности следует предоставлять конкретные примеры.

**Пример критериев проверки:**
> *   Хук должен принимать обобщенное `value` типа `T` и `delay` в миллисекундах.
> *   Он должен возвращать значение типа `T`.
> *   Возвращаемое значение должно обновляться только после истечения `delay` без изменения входного `value`.

**Пример использования:**
> ### Пример использования
> ```tsx
> const App = () => {
>   const [searchTerm, setSearchTerm] = useState('');
>   const debouncedSearchTerm = useDebounce(searchTerm, 500);
>   // ...
> };
> ```

## 4. Анти-паттерны спецификаций: чего следует избегать

Высококачественная Спецификация — это столько же об избегании двусмысленности, сколько и о предоставлении ясности. Следующие анти-паттерны нарушают основные принципы эффективного авторства:

*   **Расплывчатость:** "Сделай кнопку". (Нарушает Дисциплину мышления; отсутствует контекст, ограничения и критерии.)
*   **Составные цели:** "Создай хук `useDebounce` и проведи рефакторинг страницы профиля пользователя". (Нарушает Уважение к энергии внимания; это должны быть две отдельные Генеративные задачи.)
*   **Подразумеваемые знания:** "Реализуй стандартную логику debounce". (Не удается указать формат вывода; ожидаемая логика должна быть явно определена в критериях.)

## 5. Принцип обогащения

Основной принцип, который поднимает хорошую Спецификацию до уровня великой, — это **обогащение**: практика предоставления такого уровня детализации в `Критериях проверки`, который не оставляет места для двусмысленности. Это самый прямой способ обеспечить согласованность, надежность и правильность вывода ИИ. Больше деталей равно больше согласованности.

Обогащенная Спецификация не обязательно должна быть длинной, но она должна быть точной. Она заставляет автора продумать полное поведение желаемого артефакта, включая пограничные случаи и условия ошибок.

### 5.1. Техника авторства: процедурные спецификации для сложных задач
Для большой или сложной генеративной задачи (например, "сгенерировать целое бэкенд-приложение") `Спецификация` может быть написана как **процедурный, пошаговый план** для следования ИИ. Это мощная техника для делегирования оркестровки сложной генерации самому ИИ, используя его нативные возможности планирования. Это высшая форма обогащения.

Это не представляет собой другой "тип" `Спецификации`, а скорее другой стиль авторства, подходящий для сложности задачи.

### 5.2. Пример: обогащенные критерии проверки
Этот пример показывает обогащенную версию критериев `useDebounce` из раздела 3.3.

> #### Критерии проверки
> - [ ] Хук должен принимать обобщенное `value` типа `T` и `delay` в миллисекундах.
> - [ ] Он должен возвращать значение типа `T`.
> - [ ] Возвращаемое значение должно обновляться только после истечения `delay` без изменения входного `value`.
> - [ ] При первоначальном рендере возвращаемое значение должно быть равно начальному входному значению.
> - [ ] Если компонент размонтируется, все ожидающие отложенные обновления должны быть отменены для предотвращения утечек памяти.
> - [ ] Внутренний таймер хука должен корректно очищаться и сбрасываться всякий раз, когда изменяется входное `value`.
> - [ ] Хук должен сопровождаться набором модульных тестов, которые покрывают основную логику, поведение отмены и пограничный случай с `delay` равным `0`.
